[{"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/App.tsx":"1","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/reportWebVitals.ts":"2","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/boardState.ts":"3","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/index.tsx":"4","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/selectedMarker.ts":"5","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/constants.ts":"6","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/activePlayer.ts":"7","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/components/Square/Square.tsx":"8","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/components/Header/Header.tsx":"9","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/shouldAlertUser.ts":"10","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/index.ts":"11","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/lastMove.ts":"12"},{"size":8960,"mtime":1611862101894,"results":"13","hashOfConfig":"14"},{"size":425,"mtime":1609602775056,"results":"15","hashOfConfig":"14"},{"size":569,"mtime":1611855801318,"results":"16","hashOfConfig":"14"},{"size":567,"mtime":1609609417951,"results":"17","hashOfConfig":"14"},{"size":75,"mtime":1611071508758,"results":"18","hashOfConfig":"14"},{"size":395,"mtime":1611859946974,"results":"19","hashOfConfig":"14"},{"size":281,"mtime":1610637447444,"results":"20","hashOfConfig":"14"},{"size":1761,"mtime":1611860964092,"results":"21","hashOfConfig":"14"},{"size":455,"mtime":1609863459333,"results":"22","hashOfConfig":"14"},{"size":86,"mtime":1611070104825,"results":"23","hashOfConfig":"14"},{"size":159,"mtime":1611851564825,"results":"24","hashOfConfig":"14"},{"size":162,"mtime":1611852250707,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"28"},"148cfn6",{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"35"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"42","messages":"43","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"44"},{"filePath":"45","messages":"46","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"47"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"50","messages":"51","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/App.tsx",["54"],"import React, { useEffect } from \"react\";\nimport { useAtom } from \"jotai\";\nimport produce from \"immer\";\n\nimport { Neighbors, SpaceValue } from \"./types\";\nimport {\n  DARK,\n  LIGHT,\n  EMPTY,\n  BOARD_HEIGHT,\n  BOARD_WIDTH,\n  isLight,\n  isDark,\n} from \"./constants\";\nimport \"./App.scss\";\nimport {\n  activePlayerAtom,\n  shouldAlertUserAtom,\n  boardAtom,\n  selectedMarkerAtom,\n  lastMoveAtom,\n} from \"./atoms\";\nimport { CoordinatePair } from \"./types/CoordinatePair\";\nimport Square from \"./components/Square/Square\";\nimport Header from \"./components/Header/Header\";\nimport { useAtomDevtools } from \"jotai/devtools\";\nimport {} from \"./atoms/shouldAlertUser\";\n\nfunction App() {\n  const [boardState, updateBoardState] = useAtom(boardAtom);\n  const [lastMove, updateLastMove] = useAtom(lastMoveAtom);\n  const [selectedMarker, updateSelectedMarker] = useAtom(selectedMarkerAtom);\n  const [activePlayer, updateActivePlayer] = useAtom(activePlayerAtom);\n  const [shouldAlertUser, updateShouldAlertUser] = useAtom(shouldAlertUserAtom);\n\n  // init devtools\n  useAtomDevtools(activePlayerAtom, \"active Player\");\n  useAtomDevtools(boardAtom, \"board state\");\n  useAtomDevtools(selectedMarkerAtom, \"selected marker\");\n  useAtomDevtools(shouldAlertUserAtom, \"error state markers\");\n  useAtomDevtools(lastMoveAtom, \"last move\");\n\n  // run capture check code on each neighbor after move registers\n  useEffect(() => {\n    if (!lastMove) {\n      return;\n    }\n    const neighbors = getNeighbors(lastMove);\n    // check each neighbor of the placed marker to see if it was captured\n    for (const neighbor in neighbors as Neighbors) {\n      // TODO: Oh son of a I'M SO SORRY! (for the type atrocities committed on this soil)\n      const coordinates = neighbors[neighbor as keyof Neighbors]?.coordinates;\n\n      const spaceValue = neighbors[neighbor as keyof Neighbors]?.spaceValue;\n      if (\n        shouldBeCaptured(\n          coordinates as CoordinatePair,\n          spaceValue as SpaceValue\n        )\n      ) {\n        console.log(\"capture piece\");\n        handleCapture(coordinates as CoordinatePair);\n      }\n    }\n    // TODO: set shouldAlertUser to autoremove\n    updateShouldAlertUser((base) => []);\n    updateActivePlayer(() => (activePlayer === DARK ? LIGHT : DARK));\n  }, [lastMove]);\n\n  const makeBoard = (BOARD_WIDTH: number, BOARD_HEIGHT: number) => {\n    const boardContents: JSX.Element[][] = [];\n    for (let i = 0; i < BOARD_HEIGHT; i++) {\n      const row: JSX.Element[] = [];\n      for (let j = 0; j < BOARD_WIDTH; j++) {\n        row.push(\n          <Square\n            handleMove={handleMove}\n            spaceValue={boardState[i]?.[j]}\n            handleClickMarker={handleClickMarker}\n            coordinates={{ row: i, col: j }}\n            shouldAlertUser={shouldAlertUser.includes(`${i}-${j}`)}\n            id={`${i}-${j}`}\n            key={`${i}-${j}`}\n            isSelected={selectedMarker === `${i}-${j}`}\n          />\n        );\n      }\n      boardContents.push(row);\n    }\n    return <div className=\"board\">{boardContents}</div>;\n  };\n\n  const getNeighbors = ({ row, col }: CoordinatePair): Neighbors => {\n    const neighbors: Neighbors = {};\n    if (areValidCoordinates({ row: row - 1, col })) {\n      console.log(`North: ${boardState[row - 1]?.[col]}`);\n      neighbors.north = {\n        spaceValue: boardState[row - 1]?.[col],\n        coordinates: { row: row - 1, col },\n      };\n    }\n    if (areValidCoordinates({ row: row + 1, col })) {\n      neighbors.south = {\n        spaceValue: boardState[row + 1]?.[col],\n        coordinates: { row: row + 1, col },\n      };\n    }\n    if (areValidCoordinates({ row, col: col + 1 })) {\n      neighbors.east = {\n        spaceValue: boardState[row]?.[col + 1],\n        coordinates: { row, col: col + 1 },\n      };\n    }\n    if (areValidCoordinates({ row, col: col - 1 })) {\n      neighbors.west = {\n        spaceValue: boardState[row]?.[col - 1],\n        coordinates: { row, col: col - 1 },\n      };\n    }\n    console.log(neighbors);\n\n    return neighbors;\n  };\n\n  const areValidCoordinates = (coordinates: CoordinatePair): boolean => {\n    if (coordinates.row >= BOARD_HEIGHT || coordinates.row < 0) {\n      return false;\n    }\n    if (coordinates.col >= BOARD_WIDTH || coordinates.col < 0) {\n      return false;\n    }\n    return true;\n  };\n\n  const hasEmptyNeighbors = (coordinates: CoordinatePair): boolean => {\n    const neighbors = getNeighbors(coordinates);\n    for (let prop in neighbors) {\n      if (neighbors[prop as keyof Neighbors]?.spaceValue === EMPTY) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  const handleClickMarker = ({ row, col }: CoordinatePair) => {\n    if (\n      hasEmptyNeighbors({ row, col }) &&\n      isActivePlayerMarker(activePlayer, boardState[row][col])\n    ) {\n      selectMarker({ row, col });\n    }\n  };\n\n  const shouldBeCaptured = (\n    coordinates: CoordinatePair,\n    spaceValue: SpaceValue\n  ): boolean => {\n    if (spaceValue === activePlayer || spaceValue === EMPTY) {\n      return false;\n    }\n\n    const neighbors = getNeighbors(coordinates);\n\n    if (\n      (neighbors.north?.spaceValue === (activePlayer || undefined) &&\n        neighbors.south?.spaceValue === (activePlayer || undefined)) ||\n      (neighbors.east?.spaceValue === (activePlayer || undefined) &&\n        neighbors.west?.spaceValue === (activePlayer || undefined))\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  const handleCapture = async ({ row, col }: CoordinatePair) => {\n    await updateBoardState((base) =>\n      produce(base, (draft) => {\n        draft[row][col] = EMPTY;\n      })\n    );\n  };\n\n  const selectMarker = ({ row, col }: CoordinatePair) => {\n    updateSelectedMarker(`${row}-${col}`);\n  };\n\n  /**\n   *\n   * @param coordinatePair - coordinates to move to\n   */\n\n  const handleMove = async ({ row, col }: CoordinatePair) => {\n    if (!selectedMarker) {\n      return;\n    }\n    const [currentRow, currentCol] = selectedMarker\n      .split(\"-\")\n      .map((coordinate) => parseInt(coordinate));\n    const moveIsLegal = isMoveLegal(\n      { row, col },\n      { row: currentRow, col: currentCol }\n    );\n    const currentSpaceValue = boardState[currentRow][currentCol];\n\n    if (moveIsLegal) {\n      updateBoardState((base) =>\n        produce(base, (draft) => {\n          draft[row][col] = currentSpaceValue;\n          draft[currentRow][currentCol] = EMPTY;\n        })\n      );\n\n      updateLastMove({ row, col });\n\n      updateSelectedMarker(() => \"\");\n    }\n  };\n\n  const isMoveLegal = (target: CoordinatePair, current: CoordinatePair) => {\n    const moveIsObstructed = isMoveObstructed(target, current);\n    const markerIsCorrectColor = isActivePlayerMarker(\n      activePlayer,\n      boardState[current.row][current.col]\n    );\n    if (!moveIsObstructed && markerIsCorrectColor) {\n      return true;\n    }\n    updateShouldAlertUser((base) => [`${target.row}-${target.col}`]);\n    return false;\n  };\n\n  const isMoveObstructed = (\n    target: CoordinatePair,\n    current: CoordinatePair\n  ): boolean => {\n    // is move orthogonal, to a non-occupied space, or to itself?\n    if (\n      boardState[target.row][target.col] !== EMPTY ||\n      (target.col === current.col && target.row === current.row) ||\n      (target.col !== current.col && target.row !== current.row)\n    ) {\n      return true;\n    }\n\n    if (target.row !== current.row) {\n      // check if marker is obstructed below\n      if (target.row > current.row) {\n        for (let i = current.row + 1; i < target.row; i++) {\n          if (boardState[i][target.col] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n      // check if marker is obstructed above\n      if (target.row < current.row) {\n        for (let i = current.row - 1; i > target.row; i--) {\n          if (boardState[i][target.col] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    if (target.col !== current.col) {\n      // check if marker is obstructed to the right\n      if (target.col > current.col) {\n        for (let i = current.col + 1; i < target.col; i++) {\n          if (boardState[target.row][i] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      // check if marker is obstructed to the left\n      if (target.col < current.col) {\n        for (let i = current.col - 1; i > target.col; i--) {\n          if (boardState[target.row][i] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    console.error(\n      `somehow, code evaded all checks.  attempting move to ${target.row}, ${target.col}`\n    );\n    return true;\n  };\n\n  function isActivePlayerMarker(player: 1 | 2, marker: SpaceValue) {\n    if ((player === 1 && isLight(marker)) || (player === 2 && isDark(marker))) {\n      return true;\n    }\n    return false;\n  }\n\n  return (\n    <div className=\"App\">\n      <Header activePlayer={activePlayer} />\n      {makeBoard(BOARD_WIDTH, BOARD_HEIGHT)}\n    </div>\n  );\n}\n\nexport default App;\n","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/reportWebVitals.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/boardState.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/index.tsx",[],["55","56"],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/selectedMarker.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/constants.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/activePlayer.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/components/Square/Square.tsx",["57","58","59"],"import React, { useState, useEffect } from \"react\";\nimport classNames from \"classnames\";\n\nimport {\n  DARK,\n  EMPTY,\n  IS_DARK,\n  IS_LIGHT,\n  LIGHT,\n  KING,\n  IS_KING,\n  isLight,\n  isDark,\n} from \"../../constants\";\nimport { SpaceValue } from \"../../types\";\nimport { CoordinatePair } from \"../../types/CoordinatePair\";\nimport \"./Square.scss\";\n\ninterface Square {\n  spaceValue: SpaceValue;\n  coordinates: CoordinatePair;\n  handleMove: (coordinates: CoordinatePair) => void;\n  handleClickMarker: (coordinates: CoordinatePair) => void;\n  shouldAlertUser: boolean;\n  key: string;\n  id: string;\n  isSelected: boolean;\n}\n\nconst Square = ({\n  spaceValue,\n  coordinates,\n  handleMove,\n  handleClickMarker,\n  shouldAlertUser,\n  isSelected,\n}: Square) => {\n  const [isFlashing, setIsFlashing] = useState(false);\n\n  useEffect(() => {\n    if (shouldAlertUser) {\n      setIsFlashing(true);\n    }\n  }, [shouldAlertUser]);\n\n  useEffect(() => {\n    if (isFlashing === true) {\n      setTimeout(() => setIsFlashing(false), 500);\n    }\n  }, [isFlashing]);\n\n  const markerClasses = classNames({\n    marker: true,\n    [IS_LIGHT]: isLight(spaceValue),\n    [IS_DARK]: isDark(spaceValue),\n    [IS_KING]: spaceValue === KING,\n    highlight: isSelected,\n  });\n\n  const squareClasses = classNames({\n    square: true,\n    \"is-flashing\": isFlashing,\n  });\n\n  return (\n    <div className={squareClasses} onClick={() => handleMove(coordinates)}>\n      {spaceValue !== EMPTY && (\n        <div\n          id={`${coordinates.row}-${coordinates.col}-marker`}\n          className={markerClasses}\n          onClick={() => handleClickMarker(coordinates)}\n        >\n          {spaceValue === KING && <div className=\"kingSymbol\"></div>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Square;\n","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/components/Header/Header.tsx",["60"],"import React, { Fragment } from \"react\";\nimport { DARK, LIGHT } from \"../../constants\";\nimport \"./Header.scss\";\n\ninterface Header {\n  activePlayer: typeof DARK | typeof LIGHT;\n}\n\nconst Header = ({ activePlayer }: Header) => {\n  return (\n    <Fragment>\n      <h1 className=\"title\">Hnefatafl</h1>\n      <h3 className=\"subtitle\">\n        {activePlayer === DARK ? \"Black to move\" : \"White to move\"}\n      </h3>\n    </Fragment>\n  );\n};\n\nexport default Header;\n","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/shouldAlertUser.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/index.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/lastMove.ts",[],{"ruleId":"61","severity":1,"message":"62","line":68,"column":6,"nodeType":"63","endLine":68,"endColumn":16,"suggestions":"64"},{"ruleId":"65","replacedBy":"66"},{"ruleId":"67","replacedBy":"68"},{"ruleId":"69","severity":1,"message":"70","line":5,"column":3,"nodeType":"71","messageId":"72","endLine":5,"endColumn":7},{"ruleId":"69","severity":1,"message":"73","line":9,"column":3,"nodeType":"71","messageId":"72","endLine":9,"endColumn":8},{"ruleId":"74","severity":1,"message":"75","line":30,"column":7,"nodeType":"71","messageId":"76","endLine":30,"endColumn":13},{"ruleId":"74","severity":1,"message":"77","line":9,"column":7,"nodeType":"71","messageId":"76","endLine":9,"endColumn":13},"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'activePlayer', 'getNeighbors', 'handleCapture', 'shouldBeCaptured', 'updateActivePlayer', and 'updateShouldAlertUser'. Either include them or remove the dependency array.","ArrayExpression",["78"],"no-native-reassign",["79"],"no-negated-in-lhs",["80"],"@typescript-eslint/no-unused-vars","'DARK' is defined but never used.","Identifier","unusedVar","'LIGHT' is defined but never used.","@typescript-eslint/no-redeclare","'Square' is already defined.","redeclared","'Header' is already defined.",{"desc":"81","fix":"82"},"no-global-assign","no-unsafe-negation","Update the dependencies array to be: [activePlayer, getNeighbors, handleCapture, lastMove, shouldBeCaptured, updateActivePlayer, updateShouldAlertUser]",{"range":"83","text":"84"},[2258,2268],"[activePlayer, getNeighbors, handleCapture, lastMove, shouldBeCaptured, updateActivePlayer, updateShouldAlertUser]"]