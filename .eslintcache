[{"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/App.tsx":"1","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/reportWebVitals.ts":"2","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/boardState.ts":"3","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/index.tsx":"4","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/selectedMarker.ts":"5","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/constants.ts":"6","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/activePlayer.ts":"7"},{"size":6416,"mtime":1609622441036,"results":"8","hashOfConfig":"9"},{"size":425,"mtime":1609602775056,"results":"10","hashOfConfig":"9"},{"size":540,"mtime":1609619019852,"results":"11","hashOfConfig":"9"},{"size":567,"mtime":1609609417951,"results":"12","hashOfConfig":"9"},{"size":75,"mtime":1609615335068,"results":"13","hashOfConfig":"9"},{"size":135,"mtime":1609619491798,"results":"14","hashOfConfig":"9"},{"size":109,"mtime":1609619534443,"results":"15","hashOfConfig":"9"},{"filePath":"16","messages":"17","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"18"},"148cfn6",{"filePath":"19","messages":"20","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"23","messages":"24","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"25","messages":"26","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/App.tsx",["31","32"],"import React, { useState } from \"react\";\nimport classnames from \"classnames\";\nimport { useAtom } from \"jotai\";\nimport produce from \"immer\";\n\nimport { DARK, LIGHT, EMPTY, BOARD_HEIGHT, BOARD_WIDTH } from \"./constants\";\nimport { boardAtom } from \"./atoms/boardState\";\nimport { selectedMarkerAtom } from \"./atoms/selectedMarker\";\nimport \"./App.scss\";\nimport { activePlayerAtom } from \"./atoms/activePlayer\";\nimport { act } from \"react-dom/test-utils\";\n\n// highlight a piece by clicking on it.\n// Any piece that has an open space next to it should be highlightable\n\n// has valid move: get neighbors.  One neighbor or more is empty.\n\nfunction App() {\n  const [boardState, updateBoardState] = useAtom(boardAtom);\n  const [selectedMarker, updateSelectedMarker] = useAtom(selectedMarkerAtom);\n  const [activePlayer, updateActivePlayer] = useAtom(activePlayerAtom);\n\n  const makeBoard = (BOARD_WIDTH: number, BOARD_HEIGHT: number) => {\n    const boardContents: JSX.Element[][] = [];\n    for (let i = 0; i < BOARD_HEIGHT; i++) {\n      const row: JSX.Element[] = [];\n      for (let j = 0; j < BOARD_WIDTH; j++) {\n        const markerClasses = classnames({\n          marker: true,\n          isLight: boardState[i]?.[j] === LIGHT,\n          isDark: boardState[i]?.[j] === DARK,\n        });\n        row.push(\n          <div\n            onClick={() => handleMove(i, j)}\n            className=\"cell\"\n            id={`${i}-${j}-cell`}\n            key={`${i}-${j}`}\n          >\n            <div\n              id={`${i}-${j}-marker`}\n              className={markerClasses}\n              onClick={() => handleClickMarker(i, j)}\n            ></div>\n          </div>\n        );\n      }\n      boardContents.push(row);\n    }\n    return <div className=\"board\">{boardContents}</div>;\n  };\n\n  const hasEmptyNeighbors = (row: number, column: number): boolean => {\n    const neighbors = {\n      north: boardState[row - 1]?.[column],\n      south: boardState[row + 1]?.[column],\n      east: boardState[row][column + 1],\n      west: boardState[row][column - 1],\n    };\n    for (let prop in neighbors) {\n      if (neighbors[prop as \"north\" | \"south\" | \"east\" | \"west\"] === EMPTY) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  const handleClickMarker = (row: number, col: number) => {\n    if (hasEmptyNeighbors(row, col) && boardState[row][col] === activePlayer) {\n      selectMarker(row, col);\n    }\n  };\n\n  const selectMarker = (row: number, col: number) => {\n    removeCurrentHighlight();\n    highlightMarker(row, col);\n    updateSelectedMarker(`${row}-${col}`);\n  };\n\n  const highlightMarker = (row: number, column: number) => {\n    document\n      .getElementById(`${row}-${column}-marker`)\n      ?.classList?.add(\"highlight\");\n  };\n\n  const handleMove = (targetRow: number, targetColumn: number) => {\n    if (!selectedMarker) {\n      return false;\n    }\n    const [currentRow, currentColumn] = selectedMarker\n      .split(\"-\")\n      .map((coordinate) => parseInt(coordinate));\n    const moveIsLegal = isMoveLegal(\n      targetRow,\n      targetColumn,\n      currentRow,\n      currentColumn\n    );\n    if (moveIsLegal) {\n      const currentEl = document.getElementById(`${selectedMarker}-marker`);\n\n      // clear current marker\n      currentEl?.classList.remove(\"isLight\");\n      currentEl?.classList.remove(\"isDark\");\n\n      // add new marker\n      document\n        .getElementById(`${targetRow}-${targetColumn}-marker`)\n        ?.classList.add(activePlayer === DARK ? \"isDark\" : \"isLight\");\n\n      updateBoardState(\n        produce(boardState, (draft) => {\n          draft[targetRow][targetColumn] = activePlayer;\n          draft[currentRow][currentColumn] = EMPTY;\n        })\n      );\n\n      updateActivePlayer(activePlayer === DARK ? LIGHT : DARK);\n    }\n  };\n\n  const isMoveLegal = (\n    targetRow: number,\n    targetColumn: number,\n    currentRow: number,\n    currentColumn: number\n  ) => {\n    const moveIsObstructed = isMoveObstructed(\n      targetRow,\n      targetColumn,\n      currentRow,\n      currentColumn\n    );\n    const markerIsCorrectColor =\n      boardState[currentRow][currentColumn] === activePlayer;\n    if (!moveIsObstructed && markerIsCorrectColor) {\n      return true;\n    }\n    return false;\n  };\n\n  const isMoveObstructed = (\n    targetRow: number,\n    targetColumn: number,\n    currentRow: number,\n    currentColumn: number\n  ): boolean => {\n    // is move orthogonal, to a non-occupied space, or to itself?\n    if (\n      boardState[targetRow][targetColumn] !== EMPTY ||\n      (targetColumn === currentColumn && targetRow === currentRow) ||\n      (targetColumn !== currentColumn && targetRow !== currentRow)\n    ) {\n      return true;\n    }\n\n    if (targetRow !== currentRow) {\n      // check if marker is obstructed below\n      if (targetRow > currentRow) {\n        for (let i = currentRow + 1; i < targetRow; i++) {\n          if (boardState[i][targetColumn] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n      // check if marker is obstructed above\n      if (targetRow < currentRow) {\n        for (let i = currentRow - 1; i > targetRow; i--) {\n          if (boardState[i][targetColumn] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    if (targetColumn !== currentColumn) {\n      // check if marker is obstructed to the right\n      if (targetColumn > currentColumn) {\n        for (let i = currentColumn + 1; i < targetColumn; i++) {\n          if (boardState[targetRow][i] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      // check if marker is obstructed to the left\n      if (targetColumn < currentColumn) {\n        for (let i = currentColumn - 1; i > targetColumn; i--) {\n          if (boardState[targetRow][i] !== EMPTY) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    console.error(\n      `somehow, code evaded all checks.  attempting move to ${targetRow}, ${targetColumn}`\n    );\n    return true;\n  };\n\n  const removeCurrentHighlight = () => {\n    const el = document.getElementById(`${selectedMarker}-marker`);\n    if (el) {\n      el?.classList.remove(\"highlight\");\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      <h1 className=\"title\">Hnefatafl</h1>\n      <h3 className=\"subtitle\">\n        {activePlayer === DARK ? \"Black to move\" : \"White to move\"}\n      </h3>\n      {makeBoard(BOARD_WIDTH, BOARD_HEIGHT)}\n    </div>\n  );\n}\n\nexport default App;\n","/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/reportWebVitals.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/boardState.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/index.tsx",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/selectedMarker.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/constants.ts",[],"/Users/joshuaanderson/Desktop/desktop/code/jotai-practice/hnefatafl/src/atoms/activePlayer.ts",[],{"ruleId":"33","severity":1,"message":"34","line":1,"column":17,"nodeType":"35","messageId":"36","endLine":1,"endColumn":25},{"ruleId":"33","severity":1,"message":"37","line":11,"column":10,"nodeType":"35","messageId":"36","endLine":11,"endColumn":13},"@typescript-eslint/no-unused-vars","'useState' is defined but never used.","Identifier","unusedVar","'act' is defined but never used."]